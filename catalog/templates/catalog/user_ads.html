{% extends 'catalog/base.html' %}
{% block content %}
<style>
.new-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-size: 0.7rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 3px 10px rgba(255, 82, 82, 0.4);
    z-index: 10;
    animation: pulse 2s infinite;
}
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}
.expiry-badge {
    background-color: #ffc107;
    color: #333;
    padding: 0.3rem 0.6rem;
    border-radius: 15px;
    font-size: 0.75rem;
    font-weight: 600;
    display: inline-block;
    margin-top: 0.5rem;
}
.expiry-soon {
    background-color: #dc3545;
    color: white;
}
</style>
<div class="container mt-5">
  <h2>–ú–æ–∏—Ç–µ –æ–±—è–≤–∏</h2>
  <a href="{% url 'catalog:product_create' %}" class="btn btn-success mb-3">–ù–æ–≤–∞ –æ–±—è–≤–∞</a>
  <div class="row g-4">
    {% for product in products %}
    <div class="col-md-4">
      <div class="card" style="position: relative;">
        {% if product.is_new %}
        <span class="new-badge">üÜï –ù–û–í–ê</span>
        {% endif %}
        {% if product.get_first_image %}<img src="{{ product.get_first_image.url }}" class="card-img-top">{% endif %}
        <div class="card-body">
          <h5 class="card-title">{{ product.title }}</h5>
          <p class="card-text">{{ product.description|truncatewords:15 }}</p>
          {% with days=product.days_remaining %}
          {% if days > 5 %}
            <span class="expiry-badge">‚è∞ –û—Å—Ç–∞–≤–∞—Ç {{ days }} –¥–Ω–∏</span>
          {% elif days > 0 %}
            <span class="expiry-badge expiry-soon">‚ö†Ô∏è –ò–∑—Ç–∏—á–∞ —Å–ª–µ–¥ {{ days }} –¥–Ω–∏!</span>
          {% else %}
            <span class="expiry-badge expiry-soon">‚ùå –ò–∑—Ç–µ–∫–ª–∞</span>
          {% endif %}
          {% endwith %}
          <div class="mt-3">
            <a href="{% url 'catalog:product_update' product.pk %}" class="btn btn-sm btn-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–∞–π</a>
            <a href="{% url 'catalog:product_delete' product.pk %}" class="btn btn-sm btn-danger">–ò–∑—Ç—Ä–∏–π</a>
          </div>
        </div>
      </div>
    </div>
    {% empty %}
    <p>–ù—è–º–∞—à –ø—É–±–ª–∏–∫—É–≤–∞–Ω–∏ –æ–±—è–≤–∏.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}